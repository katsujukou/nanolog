FROM node:16.13-bullseye

ARG APP_AUTH_TOKEN_SECRET
ARG APP_AUTH_TOKEN_ISSUER
ARG DB_PASSWORD
ARG APP_CORS_ALLOWED_ORIGIN
ARG APP_SERVER_HOSTNAME

ENV PATH /var/nanolog/bin:$PATH
ENV APP_AUTH_TOKEN_SECRET ${APP_AUTH_TOKEN_SECRET}
ENV APP_AUTH_TOKEN_ISSUER ${APP_AUTH_TOKEN_ISSUER}
ENV DB_PASSWORD ${DB_PASSWORD}
ENV APP_CORS_ALLOWED_ORIGIN ${APP_CORS_ALLOWED_ORIGIN}
ENV APP_SERVER_HOSTNAME ${APP_SERVER_HOSTNAME}

CMD ["nanolog-cli", "start", "-e", "/var/nanolog/.env"]